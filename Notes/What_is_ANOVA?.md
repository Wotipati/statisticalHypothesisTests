# What is ANOVA?
分散分析(<u>An</u>alysis <u>o</u>f <u>va</u>riance, ANOVA)について
- 「ある要因が実験結果に影響を与えたかどうか（=要因の効果があったかどうか）」を判定する手法
- 「データ全体の変動」を「注目している要因の差による変動(要因変動)」と「誤差変動」に分解し，それぞれの分散の大きさを比較する（F値を計算する）ことにより検定を行う
- 要因の数によって以下のように区別して呼ばれる
  - 1要因の場合: 一元配置分散分析 (One-way ANOVA)
  - 2要因の場合: 二元配置分散分析 (Two-way ANOVA)
  - 3要因以上の場合: 多元配置分散分析 (n-way ANOVA)
- 対応ありか否かによって以下のように分類される
  - 対応なし: 要因分散分析(Factrial ANOVA)
  - 対応あり: 反復測定分散分析(Repeated-measures ANOVA))

```
対応なし一元配置分散分析
```
例) 施肥の有無が穀物の収量に影響を及ぼすか調査
- 要因: 施肥
- 誤差: 日当たり、水はけ、土壌など

#### 収集したデータ

**表1 施肥量と収量の関係**  
|      |水準1<br>(施肥量0kg)|水準2<br>(施肥量10kg)|水準3<br>(施肥量20kg)|水準4<br>(施肥量30kg)||
|:-----|:-------------|:---------------|:--------------|:--------------|:--------------|
|第一区画|9 |13|17|16||
|第二区画|11|12|16|17||
|第三区画|10|14|15|18||
|平均　　|10|13|16|17|総平均: 14|

#### データの分離
以下の①~③にしたがって、データ全体の変動を、注目している要因による変動(要因変動)と誤差による変動(誤差変動)の和に分離する
#### ①全体の変動
- データ全体の変動は**各値と総平均の差**で捉える
- 総変動と呼ぶ  

**表2 総変動(各値-総平均)**  
|水準1|水準2|水準3|水準4|
|:---|:---|:----|:---|
|-5  |-1  |3    |2|
|-3  |-2  |2    |3|
|-4  |0   |1    |4|


#### ②目的となる要因の効果による変動
- 要因による変動は、**各水準の平均と総平均の差**で捉える
- **群間変動**と呼ばれる
- 誤差による影響がなければ、同じ群（同じ水準）内では全て同じ値になるはず、という考え

**表3 群間変動(群平均-総平均)**  
|水準1|水準2|水準3|水準4|
|:---|:---|:----|:---|
|-4  |-1  |2    |3|
|-4  |-1  |2    |3|
|-4  |-1  |2    |3|


#### ③誤差効果による変動
- 注目している要因以外の要因による変動は、誤差効果による変動とし、**各値と各群の平均の差**で捉える
- **郡内変動**と呼ばれる

**表4 誤差変動(各値-群平均)**
|水準1|水準2|水準3|水準4|
|:---|:---|:----|:---|
|-1  |0  |1    |-1|
|1  |-1  |0    |0|
|0  |1  |-1    |1|

#### 分散分析の検定
- 要因変動と誤差変動の分散を用いてF検定を行う
  - 帰無仮説H<sub>0</sub>: 要因効果と誤差効果との間に差はない
  - 対立仮説H<sub>1</sub>: 要因効果と誤差効果との間に差はある
- F値 = (群間変動の分散)/(誤差変動)
  - `F値>1`の場合
    - 誤差による変動より、要因による変動が大きいため、「要因効果がある」となる
  - `F値<=1`の場合
    - 要因変動は誤差変動に埋もれてしまうため、「要因効果がない」となる

#### 例におけるF検定
- 群間変動
  - 偏差平方和 = 90
  - 自由度 = 3
  - 分散 = 30
- 誤差変動
  - 偏差平方和 = 8
  - 自由度 = 8
  - 分散 = 1
- F値 = 30  
- p値 = 0.000105653  
- 帰無仮説は棄却され、対立仮説が採択された
